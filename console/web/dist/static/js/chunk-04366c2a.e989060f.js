(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04366c2a"],{"1ddd":function(e,t,r){"use strict";r("2e2f")},2564:function(e,t,r){},"2e2f":function(e,t,r){},"3f7a":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",e._g(e._b({staticClass:"dialog",attrs:{"close-on-click-modal":!1,"modal-append-to-body":!1,visible:e.elDialogVisible},on:{close:e.onClose,"update:visible":e.toggleVisible}},"el-dialog",e.$attrs,!1),e.listeners),[e.$attrs.title?e._e():r("template",{slot:"title"},[e._t("title")],2),e._t("default"),e.noFooter?e._e():r("template",{slot:"footer"},[e.$slots.footer?e._t("footer",null,{closeDialog:function(){return e.toggleVisible(!1)}}):[e.cancelBtn?r("el-button",{on:{click:function(t){return e.toggleVisible(!1)}}},[e._v("\n        取消\n      ")]):e._e(),r("el-button",{attrs:{disabled:e.disabledBtn,loading:e.pending,type:"primary"},on:{click:e.confirm}},[e._v("\n        "+e._s(e.confirmText)+"\n      ")])]],2)],2)},i=[];let s,l;function n(){return void 0!==s||(s=void 0!==window.ontransitionend?"transitionend":void 0!==window.onwebkittransitionend?"webkittransitionend":""),s}function o(){return void 0!==l||(l=void 0!==window.onanimationend?"animationend":void 0!==window.onwebkitanimationend?"webkitanimationend":""),l}var u={name:"VDialog",inheritAttrs:!1,props:{visible:{type:Boolean,default:!0},onConfirm:Function,cancelBtn:{type:Boolean,default:!0},disabledBtn:{type:Boolean,dafault:!1},noFooter:{type:Boolean,default:!1},confirmText:{type:String,default:"确定"}},data(){return{elDialogVisible:!1,pending:!1}},computed:{listeners(){let e={};for(let t in this.$listeners)-1===["update:visible","close","confirm"].indexOf(t)&&(e[t]=this.$listeners[t]);return e}},watch:{visible:{handler(e){e!==this.elDialogVisible&&(this.elDialogVisible=e)},immediate:!0}},methods:{toggleVisible(e){this.elDialogVisible=e,this.$emit("update:visible",e)},onClose(){let e=n(),t=o();if(e&&t){let r=()=>{this.$emit("close"),this.$el.removeEventListener(e,r),this.$el.removeEventListener(t,r)};this.$el.addEventListener(e,r),this.$el.addEventListener(t,r)}else this.$nextFrame(()=>this.$emit("close"))},confirm(){const e=e=>{this.pending=!1,!(e instanceof Error)&&this.toggleVisible(!1)};this.pending=!0,this.onConfirm&&this.onConfirm().then(e,e)}}},c=u,m=(r("1ddd"),r("2877")),p=Object(m["a"])(c,a,i,!1,null,"08c14ed2",null);t["a"]=p.exports},"5f59":function(e,t,r){"use strict";r("2564")},"61d9":function(e,t,r){"use strict";var a=r("1c1e");function i(e){return a["a"].post("/api/role",e)}function s(e){return a["a"].remove("/api/role",e)}function l(e,t){return a["a"].put("/api/role",e,t)}function n(e){return a["a"].get("/api/role",e)}function o(e){return a["a"].get("/api/role",null,e)}t["a"]={create:i,remove:s,update:l,get:n,query:o}},"64f1":function(e,t,r){"use strict";var a=r("1c1e");function i(e){return a["a"].post("/api/department",e)}function s(e){return a["a"].remove("/api/department",e)}function l(e,t){return a["a"].put("/api/department",e,t)}function n(e){return a["a"].get("/api/department",e)}function o(e){return a["a"].get("/api/department",null,e)}function u(e){return a["a"].download("/api/department/exportExcel",e)}t["a"]={create:i,remove:s,update:l,get:n,query:o,exportExcel:u}},a61c:function(e,t,r){},d168:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 用户管理\n      ")])],1)],1),r("div",{staticClass:"container"},[r("div",{staticClass:"handle-box"},[r("el-form",{attrs:{inline:""}},[r("el-form-item",{attrs:{label:"账号"}},[r("el-input",{staticClass:"handle-input mr10",staticStyle:{width:"180px"},model:{value:e.filter.passport,callback:function(t){e.$set(e.filter,"passport",t)},expression:"filter.passport"}})],1),r("el-form-item",{attrs:{label:"名称"}},[r("el-input",{staticClass:"handle-input mr10",staticStyle:{width:"180px"},model:{value:e.filter.name,callback:function(t){e.$set(e.filter,"name",t)},expression:"filter.name"}})],1),r("el-form-item",{attrs:{label:"部门",prop:"departmentId"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.filter.departmentId,callback:function(t){e.$set(e.filter,"departmentId",t)},expression:"filter.departmentId"}},e._l(e.departmentList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.filter.roleId,callback:function(t){e.$set(e.filter,"roleId",t)},expression:"filter.roleId"}},e._l(e.roleList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"手机号"}},[r("el-input",{staticClass:"handle-input mr10",staticStyle:{width:"180px"},model:{value:e.filter.phone,callback:function(t){e.$set(e.filter,"phone",t)},expression:"filter.phone"}})],1),r("el-form-item",[e.$hasPermission("ACCOUNT_QUERY")?r("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:function(t){return e.queryList()}}},[e._v("查询\n          ")]):e._e(),e.$hasPermission("ACCOUNT_CREATE")?r("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:function(t){return e.create()}}},[e._v("创建\n          ")]):e._e()],1)],1)],1),r("paged-table",{attrs:{"current-page":e.filter.pageNum,data:e.tableData,"page-size":e.filter.pageSize,total:e.total},on:{"current-change":e.queryList,"size-change":e.pageSizeChange}},[r("el-table-column",{attrs:{label:"账号",prop:"passport"}}),r("el-table-column",{attrs:{label:"名称",prop:"name"}}),r("el-table-column",{attrs:{label:"状态",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:0===t.row.status?"success":"danger"}},[e._v(e._s(0===t.row.status?"启用":"禁用")+"\n          ")])]}}])}),r("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),r("el-table-column",{attrs:{label:"手机号",prop:"phone"}}),r("el-table-column",{attrs:{label:"性别",prop:"sex"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(0==t.row.sex?"女":"男")+"\n        ")]}}])}),r("el-table-column",{attrs:{label:"备注",prop:"description"}}),r("el-table-column",{attrs:{label:"最近登录时间"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(e._s(e._f("formatDate")(r.lastLoginTime)))]}}])}),r("el-table-column",{attrs:{label:"角色",prop:"roleName"}}),r("el-table-column",{attrs:{label:"部门",prop:"departmentName"}}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$hasPermission("ACCOUNT_UPDATE")?r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(r){return e.edit(t.row)}}},[e._v("编辑\n          ")]):e._e(),e.$hasPermission("ACCOUNT_DELETE")?r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(r){return e.remove(t.row.id)}}},[e._v("删除\n          ")]):e._e()]}}])})],1)],1)])},i=[],s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("af-dialog",{staticClass:"system-dialog",attrs:{"on-confirm":e.submitForm,title:e.isEdit?"编辑账号":"创建账号",visible:e.visible},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.$emit("close")}}},[r("el-form",{ref:"accountForm",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"账号",prop:"passport"}},[r("el-input",{attrs:{disabled:e.isEdit,placeholder:"账号"},model:{value:e.form.passport,callback:function(t){e.$set(e.form,"passport",t)},expression:"form.passport"}})],1),r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"状态",prop:"status"}},[r("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[r("el-radio",{attrs:{label:0}},[e._v("启用")]),r("el-radio",{attrs:{label:1}},[e._v("禁用")])],1)],1),r("el-form-item",{attrs:{label:"部门",prop:"departmentId"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.departmentId,callback:function(t){e.$set(e.form,"departmentId",t)},expression:"form.departmentId"}},e._l(e.departmentList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"角色",prop:"roleId"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.roleId,callback:function(t){e.$set(e.form,"roleId",t)},expression:"form.roleId"}},e._l(e.roleList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[r("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),r("el-form-item",{attrs:{label:"地址",prop:"address"}},[r("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),r("el-form-item",{attrs:{label:"性别",prop:"sex"}},[r("el-radio-group",{model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[r("el-radio",{attrs:{label:0}},[e._v("女")]),r("el-radio",{attrs:{label:1}},[e._v("男")])],1)],1),r("el-form-item",{attrs:{label:"备注",prop:"description"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1)},l=[],n=r("3f7a"),o=r("ccf4"),u={passport:[{required:!0,message:"请输入账号",trigger:"blur"},{type:"string",max:16,trigger:"blur",message:"账号长度不能超过16"}],name:[{required:!0,message:"请输入名称",trigger:"blur"},{type:"string",max:6,trigger:"blur",message:"名称长度不能超过6"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{type:"string",max:64,trigger:"blur",message:"密码长度不能超过64"}],status:[{required:!0,message:"请输入用户状态",trigger:"blur"},{type:"integer",min:0,trigger:"blur",message:"用户状态不能小于0"}],roleId:[{required:!0,message:"请输入角色",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"string",max:32,trigger:"blur",message:"邮箱长度不能超过32"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{type:"string",max:16,trigger:"blur",message:"手机号长度不能超过16"}],address:[{type:"string",max:64,trigger:"blur",message:"地址长度不能超过64"}],sex:[{required:!0,message:"请输入性别 0：女；1：男",trigger:"blur"},{type:"integer",min:0,trigger:"blur",message:"性别 0：女；1：男不能小于0"}],description:[{type:"string",max:128,trigger:"blur",message:"备注长度不能超过128"}],createTime:[{required:!0,message:"请输入创建时间",trigger:"blur"}]},c={name:"AccountDialog",components:{AfDialog:n["a"]},props:{defaultValues:{type:Object,default(){return{passport:"",name:"",password:"",status:"",roleId:"",departmentId:"",email:"",phone:"",address:"",sex:"",description:"",lastLoginTime:""}}},roleList:{type:Array,dafault:()=>[]},departmentList:{type:Array,dafault:()=>[]},isEdit:{type:Boolean,dafault:()=>!1}},data(){return{rules:u,form:this.defaultValues,visible:!1}},methods:{async submitForm(){try{await this.$refs.accountForm.validate()}catch(e){return Promise.reject(new Error("表单校验失败"))}try{let e=Object.assign({},this.form);this.isEdit?await o["a"].update(e.id,e):await o["a"].create(e),this.$emit("success"),this.$message.success((this.isEdit?"编辑":"创建")+"成功！")}catch(t){this.$message.error((this.isEdit?"编辑":"创建")+"失败！原因："+t.message)}}}},m=c,p=(r("5f59"),r("2877")),d=Object(p["a"])(m,s,l,!1,null,null,null),f=d.exports,g=r("0748"),b=r("61d9"),h=r("64f1"),v={name:"Account",components:{PagedTable:g["a"]},data(){return{filter:{passport:"",name:"",phone:"",roleId:"",departmentId:"",pageNum:1,pageSize:20},total:0,roleList:[],departmentList:[],tableData:[]}},created(){this.$dialog.register("account-dialog",f),this.queryList(),this.queryRoleList(),this.queryDepartmentList()},methods:{async queryList(e=1){this.filter.pageNum=e;const t=Object.assign({},this.filter),{data:r}=await o["a"].query(t);this.total=r.count,this.tableData=r.rows},async queryRoleList(){const{data:e}=await b["a"].query({pageSize:100,pageNum:1});this.roleList=e.rows},async queryDepartmentList(){const{data:e}=await h["a"].query({pageSize:100,pageNum:1});this.departmentList=e.rows},pageSizeChange(e){this.filter.pageSize=e,this.queryList()},edit(e){const t={roleList:this.roleList,departmentList:this.departmentList,isEdit:!0};t.defaultValues=Object.assign({},e),this.openDialog("account-dialog",t)},openDialog(e,t={},r={success:this.queryList}){this.$dialog.open(e,{props:t,on:r})},async remove(e){await this.$confirm("是否确认删除？","删除",{type:"warn"});try{await o["a"].remove(e),this.$message.success("删除成功！"),this.queryList()}catch(t){this.$message.error("删除失败！原因："+t.message)}},create(){const e={roleList:this.roleList,departmentList:this.departmentList,isEdit:!1};this.openDialog("account-dialog",e)}}},y=v,x=(r("d192"),Object(p["a"])(y,a,i,!1,null,"6bbd3430",null));t["default"]=x.exports},d192:function(e,t,r){"use strict";r("a61c")}}]);